$(function () {
  var chartData = [];

  $.getJSON('/readings.json', function (data) {
    // Create the chart
    console.log ("this is data: ", data);

     for (var i=0; i<data.length; i++){
      var object = {};

      object.x = moment(data[i].created_at).valueOf();
      object.y = data[i].sugar_level;
      console.log("object at loop #" + i, object);
      // chartData.push(object.x);
      // chartData.push(object.y);
      chartData.push(object);
    };

    console.log(chartData);

    $('#container').highcharts('StockChart', {
      rangeSelector: {
          selected: 1
      },
      title: {
          text: 'Glucose level chart'
      },
      series: [{
        name: 'user',
        data: chartData,
        tooltip: {
          valueDecimals: 1
        }
      }]
    });
  });
});